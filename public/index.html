<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Panda - Advanced Tap2Earn</title>
    <meta name="description" content="Evoluciona tu panda, colecciona skins √∫nicas y compite en torneos √©picos">
    <meta name="theme-color" content="#000000">
    
    <!-- Content Security Policy para Telegram -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self' https://telegram.org;
        script-src 'self' 'unsafe-inline' https://telegram.org;
        style-src 'self' 'unsafe-inline';
        img-src 'self' data: https: blob:;
        connect-src 'self' https://telegram.org;
        font-src 'self';
        object-src 'none';
        base-uri 'self';
        form-action 'none';
        frame-ancestors 'none';
    ">
    
    <!-- Telegram Web App -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div id="app">
        <!-- Splash Screen -->
        <div id="splash-screen" class="screen active">
            <div class="background-image"></div>
            <div class="background-overlay"></div>
            
            <div class="loading-content">
                <div class="progress-container" id="progressContainer">
                    <div class="progress-label">Cargando Crypto Panda Universe</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
                
                <button id="startBtn" class="start-button">INICIAR AVENTURA</button>
                
                <div class="game-features">
                    <div class="feature-item">üêº 10 Niveles de Evoluci√≥n</div>
                    <div class="feature-item">üé® 20+ Skins √önicas</div>
                    <div class="feature-item">üèÜ Torneos en Tiempo Real</div>
                    <div class="feature-item">üÉè Sistema de Cartas</div>
                </div>
            </div>
        </div>

        <!-- Main Game Interface -->
        <div id="main-game" class="screen">
            <!-- Header con m√∫ltiples stats -->
            <header class="game-header">
                <div class="player-main-info">
                    <div class="level-badge">
                        <span id="playerLevel">1</span>
                    </div>
                    <div class="player-resources">
                        <div class="resource-item">
                            <span class="resource-icon">üí∞</span>
                            <span id="playerCoins">0</span>
                            <span class="resource-symbol">$PANDA</span>
                        </div>
                        <div class="resource-item">
                            <span class="resource-icon">üíé</span>
                            <span id="playerGems">0</span>
                        </div>
                        <div class="resource-item">
                            <span class="resource-icon">‚ö°</span>
                            <span id="energyText">6000/6000</span>
                        </div>
                    </div>
                </div>

                <div class="energy-container">
                    <div class="energy-bar">
                        <div class="energy-fill" id="energyFill"></div>
                    </div>
                </div>

                <div class="quick-actions">
                    <button class="action-btn" id="dailyRewardBtn" title="Recompensa Diaria">
                        <span>üéÅ</span>
                    </button>
                    <button class="action-btn" id="tournamentBtn" title="Torneos">
                        <span>üèÜ</span>
                    </button>
                    <button class="action-btn" id="friendsBtn" title="Amigos">
                        <span>üë•</span>
                    </button>
                </div>
            </header>

            <!-- Navigation Tabs -->
            <nav class="game-navigation">
                <div class="nav-tabs">
                    <button class="nav-tab active" data-tab="tap">
                        <span class="tab-icon">üëÜ</span>
                        <span class="tab-text">TAP</span>
                    </button>
                    <button class="nav-tab" data-tab="evolution">
                        <span class="tab-icon">üêº</span>
                        <span class="tab-text">EVOLUCION</span>
                    </button>
                    <button class="nav-tab" data-tab="skins">
                        <span class="tab-icon">üé®</span>
                        <span class="tab-text">SKINS</span>
                    </button>
                    <button class="nav-tab" data-tab="cards">
                        <span class="tab-icon">üÉè</span>
                        <span class="tab-text">CARTAS</span>
                    </button>
                    <button class="nav-tab" data-tab="clan">
                        <span class="tab-icon">üèòÔ∏è</span>
                        <span class="tab-text">CLAN</span>
                    </button>
                    <button class="nav-tab" data-tab="shop">
                        <span class="tab-icon">üõí</span>
                        <span class="tab-text">TIENDA</span>
                    </button>
                </div>
            </nav>

            <!-- Main Content Area -->
            <main class="game-content">
                <div id="tab-content" class="tab-content">
                    <div id="panda-container">
                        <div id="panda">
                            <div class="nose"></div>
                        </div>
                        <div class="combo-display" id="comboDisplay">
                            <span class="combo-text">COMBO</span>
                            <span class="combo-count">x1</span>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Bottom Bar -->
            <footer class="game-footer">
                <div class="boost-indicators">
                    <div class="boost-item" id="skinBoost">
                        <span>üé®</span>
                        <span class="boost-value">1.0x</span>
                    </div>
                    <div class="boost-item" id="levelBoost">
                        <span>üêº</span>
                        <span class="boost-value">1.0x</span>
                    </div>
                    <div class="boost-item" id="cardBoost">
                        <span>üÉè</span>
                        <span class="boost-value">0%</span>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- JavaScript con detecci√≥n mejorada de Telegram -->
    <script>
    // ===== DETECCI√ìN MEJORADA DE TELEGRAM =====
    (function() {
        console.log('üîç Iniciando detecci√≥n de Telegram Web App...');
        
        // Esperar a que Telegram Web App est√© disponible
        function waitForTelegram(callback) {
            if (window.Telegram && window.Telegram.WebApp) {
                callback();
            } else {
                setTimeout(() => waitForTelegram(callback), 100);
            }
        }
        
        waitForTelegram(function() {
            console.log('‚úÖ Telegram Web App detectado');
            const tg = window.Telegram.WebApp;
            
            // Inicializar Telegram
            tg.ready();
            tg.expand();
            
            // Configurar tema
            tg.setHeaderColor('#000000');
            tg.setBackgroundColor('#000000');
            
            console.log('üë§ Usuario:', tg.initDataUnsafe?.user);
            console.log('üåê Plataforma:', tg.platform);
            console.log('üìè Viewport:', tg.viewportHeight, 'x', tg.viewportWidth);
            
            // Marcar que estamos en Telegram
            window.isTelegram = true;
        });
        
        // Fallback despu√©s de 3 segundos
        setTimeout(() => {
            if (!window.isTelegram) {
                console.log('üåê Modo navegador est√°ndar');
                window.isTelegram = false;
            }
        }, 3000);
    })();
    </script>
    
    <script src="js/main.js"></script>
</body>
</html>
